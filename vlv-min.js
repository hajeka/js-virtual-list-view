function jsvlv(e,n,t,o){function i(e,n){q||o.onSelectRow(e,n)}function r(e,n){n.addEventListener("click",function(){i(e,n)},!1)}function l(){var e;2>Math.abs(z)?(P+=z,z=0):(e=Math.round(.6*z),P+=e,z-=e)}function c(){var e,t;if(l(),0>P)for(S.style.top=P+"px",e=O+1;n-P-I>0;){if(!(j>e)){I>n?(P=n-I,S.style.top=P+"px"):(S.style.top="0px",P=0);break}t=B[e-1].index+1,v(t),e++}else P>0&&(P=0,z=0,S.style.top="0px");0!=z&&requestAnimationFrame(c)}function u(e){e.preventDefault(),q||(e.stopPropagation(),s(),z+=e.wheelDeltaY,requestAnimationFrame(c))}function a(e){var n=!1;if(!q){switch(e.keyCode){case g:d(w),n=!0;break;case R:d(x),n=!0;break;case y:case F:-1!=J&&(o.onSelectRow(B[J].index,B[J].element),n=!0)}n&&(e.preventDefault(),e.stopPropagation())}}function d(e){var n,t;-1==J?(J=f(),o.onFocusRow(B[J].index,B[J].element)):(n=J+e,n>=0&&j>n&&(e==x&&n>O&&(t=B[O].index+1,v(n)),o.onBlurRow(B[J].index,B[J].element),h(n),o.onFocusRow(B[n].index,B[n].element),J=n))}function s(){-1!=J&&(o.onBlurRow(B[J].index,B[J].element),J=-1)}function f(){for(var e=-P,n=0,t=0;B.length>t&&!(n>=e);t++)n+=B[t].height;return t}function h(e){for(var t=0,o=0,i=0;B.length>i&&(o=B[i].height,i!=e);i++)t+=o;-P>t?(z+=-(P+t),requestAnimationFrame(c)):o+t>n-P&&(z-=t+o-n+P,requestAnimationFrame(c))}function v(e){var n,o=t.contentForRowAtIndex(e);S.appendChild(o),n=$(o).outerHeight(!0),I+=n,B.push({index:e,element:o,height:n}),r(e,o),O=e}function p(){for(var e=0;n>I&&j>e;)v(e),e++}function m(){for(s();S.firstChild;)S.removeChild(S.firstChild);S.style.top="0px",B=[],M=0,O=-1,I=0,P=0,j=t?t.numberOfRows():0}var w=-1,x=1,g=38,R=40,y=13,F=32,C=this,b="vlv"+Math.round(1e6*Math.random()),k='<div id="<%= id %>" class="vlv-container" style="width:<%=width %>px;height:<%=height %>px;"></div>',E=$(_.template(k,{id:b,width:e,height:n})),A=E[0],D=null,L=$('<div class="vlv-content"></div>'),S=L[0],q=!1,B=[],M=0,O=-1,I=0,P=0,z=0,H=!1,j=t?t.numberOfRows():0,J=-1;return o=o||{},o.onSelectRow=o.onSelectRow||function(){},o.onFocusRow=o.onFocusRow||function(){},o.onBlurRow=o.onBlurRow||function(){},C.getElement=function(){return A},C.show=function(e){A.appendChild(S),A.addEventListener("mousewheel",u,!0),document.addEventListener("keydown",a,!0),e.appendChild(A),H=!0,D=e,m(),p()},C.hide=function(){A.removeEventListener("mousewheel",u,!0),document.removeEventListener("keydown",a,!0),H&&(D&&D.removeChild(A),H=!1)},C.reload=function(){m(),p()},C.freeze=function(){q=!0},C.unfreeze=function(){q=!1},C.dbgdmp=function(){var e={scrollDistance:P,scrollDistancePending:z,contentHeight:I,firstIndex:M,lastIndex:O,indexOfFocused:J,contentTop:S.style.top};console.log(JSON.stringify(e))},C}