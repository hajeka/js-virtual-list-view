function jsvlv(e,n,t,o){function i(e,n){L||o.onSelectRow(e,n)}function r(e,n){n.addEventListener("click",function(){i(e,n)},!1)}function d(){var e;2>Math.abs(P)?(I+=P,P=0):(e=Math.round(.6*P),I+=e,P-=e)}function u(){var e,t;if(d(),D.style.top=I+"px",0>I)for(e=O+1;n-I-B>0;){if(!(z>e)){I=n-B,D.style.top=I+"px";break}t=q[e-1].index+1,v(t),e++}else I>0&&(D.style.top="0px",I=0);0!=P&&requestAnimationFrame(u)}function l(e){e.preventDefault(),L||(e.stopPropagation(),s(),P+=e.wheelDeltaY,requestAnimationFrame(u))}function c(e){var n=!1;L||(e.keyCode==x?(a(w),n=!0):e.keyCode==y&&(a(g),n=!0),n&&(e.preventDefault(),e.stopPropagation()))}function a(e){var n,t;-1==H?(H=f(),o.onFocusRow(q[H].index,q[H].element)):(n=H+e,n>0&&z>n&&(e==g&&n>O&&(t=q[O].index+1,v(n)),o.onBlurRow(q[H].index,q[H].element),h(n),o.onFocusRow(q[n].index,q[n].element),H=n)),R.dbgdmp()}function s(){-1!=H&&(o.onBlurRow(q[H].index,q[H].element),H=-1)}function f(){for(var e=-I,n=0,t=0;q.length>t&&!(n>=e);t++)n+=q[t].height;return t}function h(e){for(var t=0,o=0,i=0;q.length>i&&(o=q[i].height,i!=e);i++)t+=o;-I>t?(P+=-(I+t),requestAnimationFrame(u)):o+t>n-I&&(P-=t+o-n+I,requestAnimationFrame(u))}function v(e){var n,o=t.contentForRowAtIndex(e);D.appendChild(o),n=$(o).outerHeight(!0),B+=n,q.push({index:e,element:o,height:n}),r(e,o),O=e}function m(){for(var e=0;n>B&&z>e;)v(e),e++}function p(){for(s();D.firstChild;)D.removeChild(D.firstChild);D.style.top="0px",q=[],M=0,O=-1,B=0,I=0,z=t?t.numberOfRows():0}var w=-1,g=1,x=38,y=40,R=this,C="vlv"+Math.round(1e6*Math.random()),F='<div id="<%= id %>" class="vlv-container" style="width:<%=width %>px;height:<%=height %>px;"></div>',b=$(_.template(F,{id:C,width:e,height:n})),k=b[0],E=null,A=$('<div class="vlv-content"></div>'),D=A[0],L=!1,q=[],M=0,O=-1,B=0,I=0,P=0,S=!1,z=t?t.numberOfRows():0,H=-1;return o=o||{},o.onSelectRow||function(){},o.onFocusRow||function(){},o.onBlurRow||function(){},R.getElement=function(){return k},R.show=function(e){k.appendChild(D),k.addEventListener("mousewheel",l,!0),document.addEventListener("keydown",c,!0),e.appendChild(k),S=!0,E=e,p(),m()},R.hide=function(){k.removeEventListener("mousewheel",l,!0),document.removeEventListener("keydown",c,!0),S&&(E&&E.removeChild(k),S=!1)},R.reload=function(){p(),m()},R.freeze=function(){L=!0},R.unfreeze=function(){L=!1},R.dbgdmp=function(){var e={scrollDistance:I,scrollDistancePending:P,contentHeight:B,firstIndex:M,lastIndex:O,indexOfFocused:H,contentTop:D.style.top};console.log(JSON.stringify(e))},R}