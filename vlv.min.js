function jsvlv(e,n,t,o){function i(e,n){B||o.onSelectRow(e,n)}function l(e,n){n.addEventListener("click",function(){i(e,n)},!1)}function r(){var e;2>Math.abs(z)?(j+=z,z=0):(e=Math.round(.6*z),j+=e,z-=e)}function u(){var e,t;if(r(),0>j)for(q.style.top=j+"px",e=O+1;n-j-P>0;){if(!(N>e)){P>n?(j=n-P,q.style.top=j+"px"):(q.style.top="0px",j=0);break}t=H[e-1].index+1,p(t),e++}else j>0&&(j=0,z=0,q.style.top="0px");0!=z&&requestAnimationFrame(u)}function a(e){e.preventDefault(),B||(e.stopPropagation(),h(),z+=e.wheelDeltaY,requestAnimationFrame(u))}function c(e){B||(K.enable(),e.preventDefault())}function s(e){K.disable(),e.preventDefault()}function d(e){var n=!1;if(!B){switch(e.keyCode){case R:f(x),n=!0;break;case y:f(b),n=!0;break;case D:case F:-1!=T&&(o.onSelectRow(H[T].index,H[T].element),n=!0)}n&&(e.preventDefault(),e.stopPropagation())}}function f(e){var n,t;-1==T?(T=v(),o.onFocusRow(H[T].index,H[T].element)):(n=T+e,n>=0&&N>n&&(e==b&&n>O&&(t=H[O].index+1,p(n)),o.onBlurRow(H[T].index,H[T].element),m(n),o.onFocusRow(H[n].index,H[n].element),T=n))}function h(){-1!=T&&(o.onBlurRow(H[T].index,H[T].element),T=-1)}function v(){for(var e=-j,n=0,t=0;H.length>t&&!(n>=e);t++)n+=H[t].height;return t}function m(e){for(var t=0,o=0,i=0;H.length>i&&(o=H[i].height,i!=e);i++)t+=o;-j>t?(z+=-(j+t),requestAnimationFrame(u)):o+t>n-j&&(z-=t+o-n+j,requestAnimationFrame(u))}function p(e){var n,o=t.contentForRowAtIndex(e);q.appendChild(o),n=$(o).outerHeight(!0),P+=n,H.push({index:e,element:o,height:n}),l(e,o),O=e,Y=(Y*e+n)/(e+1),G=Y*N}function w(){for(var e=0;n>P&&N>e;)p(e),e++}function g(){for(h();q.firstChild;)q.removeChild(q.firstChild);q.style.top="0px",H=[],M=0,O=-1,P=0,j=0,N=t?t.numberOfRows():0}var x=-1,b=1,R=38,y=40,D=13,F=32,C=this,k="vlv"+Math.round(1e6*Math.random()),E='<div id="<%= id %>" class="vlv-container" style="width:<%=width %>px;height:<%=height %>px;"></div>',I=$(_.template(E,{id:k,width:e,height:n})),A=I[0],L=null,S=$('<div class="vlv-content"></div>'),q=S[0],B=!1,H=[],M=0,O=-1,P=0,j=0,z=0,J=!1,N=t?t.numberOfRows():0,T=-1,Y=0,G=0,K=null;return o=o||{},o.onSelectRow=o.onSelectRow||function(){},o.onFocusRow=o.onFocusRow||function(){},o.onBlurRow=o.onBlurRow||function(){},scrollInfoDelegate={},scrollInfoDelegate.scrollHeight=function(){return 5e3},scrollInfoDelegate.clientHeight=function(){return 300},C.getElement=function(){return A},C.show=function(e){A.appendChild(q),K=new jsvlvscrollbar,A.appendChild(K.getElement()),I.bind("mouseenter",c),I.bind("mouseleave",s),A.addEventListener("mousewheel",a,!0),document.addEventListener("keydown",d,!0),e.appendChild(A),J=!0,L=e,g(),w()},C.hide=function(){I.bind("mouseenter",c),I.bind("mouseleave",s),A.removeEventListener("mousewheel",a,!0),document.removeEventListener("keydown",d,!0),J&&(L&&L.removeChild(A),J=!1)},C.reload=function(){g(),w()},C.freeze=function(){B=!0,K.disable()},C.unfreeze=function(){B=!1,K.enable()},C.dbgdmp=function(){var e={scrollDistance:j,scrollDistancePending:z,contentHeight:P,firstIndex:M,lastIndex:O,indexOfFocused:T,contentTop:q.style.top};console.log(JSON.stringify(e))},C}